<!DOCTYPE html><html><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="description" content="most opinionated blog"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="alternative" href="/blog/rss.xml" title="devthewild" type="application/atom+xml"><link rel="icon" href="/favicon.png"><title>devthewild</title><link rel="stylesheet" href="/blog/css/main.css" type="text/css"><!--[if lt IE 9]><script>(function(a,b){a="abbr article aside audio bdi canvas data datalist details dialog figcaption figure footer header hgroup main mark meter nav output progress section summary template time video".split(" ");for(b=a.length-1;b>=0;b--)document.createElement(a[b])})()</script><![endif]--></head><body><header class="head"><h1 class="head-title u-fl"><a href="/blog/">devthewild</a></h1><nav class="head-nav u-fr"><ul class="head-nav__list"><li class="head-nav__item"><a href="/blog/" class="head-nav__link">Home</a></li><li class="head-nav__item"><a href="/blog/archives" class="head-nav__link">Archives</a></li></ul></nav></header><main class="main"><article class="post"><header class="post__head"><time datetime="2014-09-09T15:00:00.000Z" class="post__time">10th Sep, 2014</time><h1 class="post__title"><a href="/blog/2014/09/10/prototyping-swipe-and-drag-gestures-with-framer-3/">Framer에서 swipe/drag 제스쳐 프로토타이핑하기</a></h1></header><div class="post__main echo"><blockquote>
<h3>Translation of &quot;<a href="https://medium.com/@gem_ray/prototyping-swipe-and-drag-gestures-with-framer-3-2e405d50b600" target="_blank" rel="external">Prototyping swipe and drag gestures with Framer 3</a>&quot; into Korean, under the same license as the original.</h3>
</blockquote>
<p>우리는 <a href="https://www.potluck.it/" target="_blank" rel="external">Potluck</a>에서 iOS앱에서 인터렉션을 테스트해보고 프로토타이핑을 하기 위해 Framer.js를 사용하기 시작했다. Framer는 모바일과 데스크탑 앱에서의 인터렉션 프로토타이핑과 에니메이션을 위한 자바스크립트 프레임워크다. 쿼츠 콤포저(Quartz Composer)보다 러닝커브가 훨씬 낮고 아이폰과 데스크탑 양쪽에서 쉽게 실행할 수 있는 훌륭한 대안이다. 키노트에서 시작해서 실제같은 인터렉티브 프로토타입을 단계별로 만들 수 있다.</p>
<p>자바스크립트 기반이기 때문에 특히 드래그나 스와이프같은 복잡한 제스쳐를 만들 때 좋다. 스와이프 거리에 따라 엘리먼트를 움직이거나 사라지게할 때 혹은 특정거리 이상 스와이프할 때 액션이 발생하도록 할 수 있다.</p>
<p>신생 프로젝트라 예제나 문서들이 너무 없다. 그래서 배웠던 것들을 공유하려고 생각했다.</p>
<hr>
<p>시작하기 전에 타이핑하기 귀찮은 사람을 위해 [CodePen](http://codepen.io/seoh/full/AqycD에 완성본을 올려놨다.</p>
<h1>Activate on release</h1>
<p>다른 액션을 가진 테이블 셀들로 간단한 예제를 시작해보자.</p>
<p>일단 보통 아이폰 스크린을 표시하기 위한 컨테이너 뷰를 만들어보자. 시스템 상태바를 가진 웹앱을 프로토타이핑하기 위해 높이는 598px로 정했다. (역주, 원문에서는 1096px였지만 웹에서 확인하기 좋게 절반으로 줄였다.)</p>
<p data-height="630" data-theme-id="0" data-slug-hash="teAkE" data-default-tab="js" data-user="seoh" class="codepen"></p>
<p>셀에서 사용자에게 보이는 부분을 정한 컨테이너를 만들고, 화면 밖에서 슬라이드하면 셀이 나타나도록 할 것이다.</p>
<p data-height="630" data-theme-id="0" data-slug-hash="hrvAG" data-default-tab="js" data-user="seoh" class="codepen"></p>
<p>이렇게 보일 것이다.</p>
<p><img src="/blog/images/prototyping-swipe-and-drag-gestures-with-framer-3/1.png" alt=""></p>
<p>이제 셀에 드래그를 추가해보자.</p>
<p data-height="630" data-theme-id="0" data-slug-hash="lqmjo" data-default-tab="js" data-user="seoh" class="codepen"></p>
<p>원하는 기능은 아니지만 어디로든 드래그할 수 있다.</p>
<p><img src="/blog/images/prototyping-swipe-and-drag-gestures-with-framer-3/2.gif" alt=""></p>
<hr>
<p>더 구체적인 제스쳐를 구현하기 위해 드래그 이벤트 핸들러를 사용할 수도 있다. 뭔가 드래그할 때 세가지 이벤트가 발생한다. <code>Events.DragStart</code>는 드래그를 시작할 때 한번, <code>Events.DragEnd</code>는 드래그를 놓았을 때 한번 발생한다. <code>Events.DragMove</code>는 마우스나 손가락을 움직일 때 계속 발생한다.</p>
<p>draggable은 &quot;speed&quot; 속성을 갖는데 마우스 움직임에 따라 어느 정도의 속도로 움직일지 결정한다. 속도를 <code>0</code>으로 설정하면 물체가 해당하는 방향(축)으로 이동하지 않게 된다.</p>
<p data-height="630" data-theme-id="0" data-slug-hash="DKtdp" data-default-tab="js" data-user="seoh" class="codepen"></p>
<p>드래그가 끝났을 때 무엇을 할지 정할 수도 있는데, 여기에서는 원래 물체를 자리로 돌아가게 해보자.</p>
<p data-height="630" data-theme-id="0" data-slug-hash="GHwLo" data-default-tab="js" data-user="seoh" class="codepen"></p>
<p><img src="/blog/images/prototyping-swipe-and-drag-gestures-with-framer-3/3.gif" alt=""></p>
<hr>
<p>이제 화면 밖의 엘리먼트가 드래그할 때 나타나도록 해보자. 그 엘리먼트는 셀 컨테이너의 차일드 뷰가 될 것이고(그래서 셀과 함께 움직일 것이고) 그냥 화면 밖에 놓도록 하겠다.</p>
<p data-height="630" data-theme-id="0" data-slug-hash="liKwL" data-default-tab="js" data-user="seoh" class="codepen"></p>
<p>이 액션 바를 추가한 다음에 셀을 왼쪽으로 끌면 화면 오른쪽 끝에서 나타나는걸 볼 수 있다.</p>
<p><img src="/blog/images/prototyping-swipe-and-drag-gestures-with-framer-3/4.gif" alt=""></p>
<p>좀 재미있는걸 넣어보자. 드래그 핸들러는 액션 바를 조금이라도 움직일 때마다 실행되는데, 얼마나 셀을 움직이는지에 따라 색깔을 바꾸게 만들 수 있다.</p>
<p>(얼마나 셀을 움직였는지에 대한)범위를 다른 (바의 색상)범위로 바꾸는 것은 <code>Utils.mapRange</code> 함수를 통해 쉽게 할 수 있다.</p>
<p>(역주: 원문은 원래 framerjs 2를 기준으로 작성되어 <a href="http://processing.org/" target="_blank" rel="external">Proccessing 프레임워크</a>의 <code>map_range</code>라는 함수를 사용했는데 중요한 정보는 아니다.)</p>
<p>이 함수에서는 <code>[low1, high1]</code> 범위에 있는 value를 <code>[low2, high2]</code> 범위에서의 같은 위치(비율)로 변환해준다. 이제 셀의 <em>x축 좌표</em>를 액션 바의 <em>투명도</em>로 바꿔보자.</p>
<p data-height="630" data-theme-id="0" data-slug-hash="DHBev" data-default-tab="js" data-user="seoh" class="codepen"></p>
<p>셀을 드래그할 때 액션 바의 색은 다음과 같이 변한다.</p>
<p><img src="/blog/images/prototyping-swipe-and-drag-gestures-with-framer-3/5.gif" alt=""></p>
<p>충분히 액션 바를 드래그했을 때는 그대로 열려있도록 만들고 싶다. 이걸 하려면, DragEnd 핸들러에서 얼마나 드래그되었는지 확인하고 특정 너비를 넘었다면 계속 열려있도록 해보자.</p>
<p data-height="630" data-theme-id="0" data-slug-hash="qCdrl" data-default-tab="js" data-user="seoh" class="codepen"></p>
<p><img src="/blog/images/prototyping-swipe-and-drag-gestures-with-framer-3/6.gif" alt=""></p>
<h1>Activate on threshold</h1>
<p>탭을 밀었을 때 계속 열려있도록 해봤다. 탭까지 가지 않고 액션을 할 수는 없을까? iOS 6의 당겨서 새로고침이 좋은 예다. 충분히 당기면 탭까지 가지 않아도 새로고침이 일어난다. (역주, 여기에서는 특정 길이만큼 드래그 후 이벤트 발생으로 애니메이션을 실행하는 것까지만 예제로 한다.)</p>
<p>위아래로 움직이는 두번째 셀을 만들어보자.</p>
<p data-height="630" data-theme-id="0" data-slug-hash="udyBe" data-default-tab="js" data-user="seoh" class="codepen"></p>
<p>셀을 100px 아래로 내리면 쪼그라들게 해보자. 일단 이렇게 시도해봤다.</p>
<p data-height="630" data-theme-id="0" data-slug-hash="ekgDo" data-default-tab="js" data-user="seoh" class="codepen"></p>
<p><img src="/blog/images/prototyping-swipe-and-drag-gestures-with-framer-3/7.gif" alt=""></p>
<p>애니메이션이 좀 산만하다. 드래그할 때마다 계속 DragMove 이벤트가 발생하고 계속 애니메이션을 시작하려고 한다. 그래서 조건이 만족될 때 딱 한번만 발생하도록 해보자.</p>
<p data-height="630" data-theme-id="0" data-slug-hash="trboC" data-default-tab="js" data-user="seoh" class="codepen"></p>
<p><img src="/blog/images/prototyping-swipe-and-drag-gestures-with-framer-3/8.gif" alt=""></p>
<p>(역주, 원문에서는 Drag와 Animate 기능이 충돌해서 제대로 Animate가 작동하지 않아 Drag하는 레이어와 Animate되는 레이어를 따로 뒀는데 버그가 수정되었는지 잘 작동해서 그 이하 부분은 생략했다.)</p>
<hr>
<h1>아이폰에서 테스트</h1>
<p>Framer Studio 1.7에서 Mirror라는 굉장히 편한 기능이 추가되었다. Studio에서 작업한 내용을 저장하고 Mirror 버튼을 누르면 작업중인 컴퓨터를 자동으로 서버로 사용해서 외부에서 접근할 수 있는 주소를 생성해준다. (역주, 원문에서는 Dropbox Public folder에 대한 내용이었지만 Mirror 기능이 더 유용하다고 생각해서 변경했다.)</p>
<script async src="http://codepen.io/assets/embed/ei.js"></script></div><footer class="post__foot u-cf"><ul class="post__tag u-fl"><li class="post__tag__item"><a href="/blog/tags/framerjs/" class="post__tag__link">framerjs</a></li><li class="post__tag__item"><a href="/blog/tags/prototyping/" class="post__tag__link">prototyping</a></li></ul><a href="https://github.com/seoh/blog/tree/master/source/_posts/prototyping-swipe-and-drag-gestures-with-framer-3.md" class="post__foot-link u-fr">Pull Request</a><a href="https://github.com/seoh/blog/issues/new" class="post__foot-link u-fr">Tell me</a></footer></article><article class="post"><header class="post__head"><time datetime="2014-08-08T15:00:00.000Z" class="post__time">9th Aug, 2014</time><h1 class="post__title"><a href="/blog/2014/08/09/coding-dojo-2nd/">Coding Dojo #2 후기</a></h1></header><div class="post__main echo"><p>저번에 이은 <a href="http://osxdev.org/forum/index.php?threads/8-6-swift-%EC%BD%94%EB%94%A9%EB%8F%84%EC%9E%A5-2%ED%9A%8C-%EA%B3%B5%EC%A7%80.373/" target="_blank" rel="external">Coding Dojo</a>에 다녀왔다. 이번 범위는 함수에서 클로저까지.</p>
<h1>1. 스코프 내의 변수 잡기</h1>
<blockquote>
<p>클로저는 사용자의 코드 안에서 전달되거나 사용할 수 있는 기능을 포함한 독립적인 블록(block)입니다. Swift에서의 클로저는 C 및 Objective-C 의 blocks와 유사하며, 다른 언어의 람다(lambda)와도 유사합니다. 클로저는 자신이 정의된 컨텍스트(context)로부터 임의의 상수 및 변수의 참조(reference)를 획득(capture)하고 저장할 수 있습니다.</p>
<p><a href="http://seoh.github.io/Swift-Korean/#09-closures-">09 클로저 (Closures) by inureyes</a></p>
</blockquote>
<p>for-loop(<code>for var...</code>)의 스코프에 있는 변수를 사용하는 함수를 만드는데, 해당하는 변수의 값이 스코프 내에서 계속 변하는 경우에 loop가 끝난 뒤 당연히 마지막값을 기준으로 함수가 실행되는 상황에서 현재값을 저장할 수 있는 방법에 대한 문제였다.</p>
<p>해결책은</p>
<ol>
<li>변수를 다시 캡처한다. <code>var _i = i</code></li>
<li>for-loop를 돌 때 <code>for var...</code>가 아니라 for-in으로 돌면 상수<code>let</code>가 되어 따로 캡처할 필요가 없다.</li>
<li>값을 받아서 그 값을 캡처하는 함수를 리턴하는 함수를 만든다.</li>
</ol>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="func"><span class="keyword">func</span> <span class="title">capture</span><span class="params">(i:Int, closure:Int-&gt;Int)</span></span> -&gt; ()-&gt;<span class="type">Int</span> &#123;  </span><br><span class="line">    <span class="func"><span class="keyword">func</span> <span class="title">sth</span><span class="params">()</span></span> -&gt; <span class="type">Int</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> closure(i)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> sth</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// capture(i)&#123; $0*$0 &#125;</span></span><br></pre></td></tr></table></figure>
<p>3번의 경우를 더 간단하게 만들기 위해서 JavaScript의 즉시실행함수(IIFE)를 흉내내고 싶었는데, <a href="http://stackoverflow.com/questions/25163311/type-inference-of-iife-in-swift" target="_blank" rel="external">Swift의 버그</a> 때문에 현재 단순히 값만 리턴하는 IIFE도 <code>var</code>는 안되고 <code>let</code>을 써야 타입 추론이 가능하며, let을 쓰더라도 함수를 리턴하는 경우에도 에러가 나고, IIFE 속에서 조건문(conditional statement)이 존재할 경우 경우의 수에 대한 superset을 추론하는게 아니라 그냥 에러가 난다.</p>
<h1>2. 부분함수와 합성함수의 단계적 구현</h1>
<h3>2.1. 기본 구현</h3>
<p>Swift에서도 함수형 프로그래밍 스타일을 지원하도록 Array에 filter, map, reduce 등의 메소드들이 존재해서 array.filter{}.map{}.reduce(){} 같은 스타일로 작성할 수 있다. 그래서 특정 조건까지의 배열을 뽑아서(<code>take</code>) filter와 map을 체이닝해서 변이(tramsform)된 배열을 구하는 문제부터 시작했다. 앞/뒤에서 특정 길이만큼 읽는 함수는 Swift의 기본 라이브러리에서 <code>prefix와</code> <code>suffix</code>를 통해 지원하고 함수형 프로그래밍에서는 보통 <code>take</code>/<code>takeRight라는</code> 이름으로 지원된다. 특정 조건까지 읽는 함수는 <code>takeWhile</code>이라고 보통 부르는데, Swift에서 구현되어있지 않아서 도장에서는 <a href="https://github.com/pNre/ExSwift/#instance-methods" target="_blank" rel="external">ExSwift</a>에 있는 <code>takeWhile</code>의 소스가 제공되었다.</p>
<h3>2.2. Pythonic solution</h3>
<p>Python, underscore.js처럼 filter/map/reduce라는 함수에 sequence를 인자로 넘기는 식으로 개발을 하다보면 체이닝이 아니라 reduce(map(filter(... 처럼 전역함수를 이용해 구현할 수도 있는데, 이럴 경우에는 실행되는 순서와 함수호출의 순서가 역순이고, 값을 평가하는 함수를 인자로 넘길 때 인자로 받는 전역함수와의 거리가 멀어져서 가독성이 떨어지는 문제가 생긴다. 이 문제를 부분 함수(partial function)와 합성 함수(compose function)을 이용해서 인자를 받는 순서를 바꾸면 훨씬 가독성이 올라간다.</p>
<h3>2.3. Functional Programming</h3>
<p>함수형 프로그래밍으로 구현하기 위해서는 일단 1급 시민(first-class citizen, 혹은 1급 함수나 1급 객체 등으로 불린다)이라는 개념에 대해 이해가 먼저 필요하다. Java의 경험이 있다면 <a href="http://blog.doortts.com/135" target="_blank" rel="external">함수형 언어로 가는 길 (중편) - 일급객체</a>, JavaScript의 경험이 있다면 <a href="http://www.nextree.co.kr/p4150/" target="_blank" rel="external">Javascript : 함수(function) 다시 보기</a>라는 자세한 설명의 글들이 있고 영문으로는 더 자세하고 풍부한 자료들이 있다. 그리고 함수형 프로그래밍에 대한 패러다임의 이해도 필요한데, 가장 좋은 방법은 함수형 프로그래밍을 지원하는 언어를 배우는 것이다. Twitter에서 만든 Scala School이라는 Scala 입문 강의가 있는데 <a href="http://twitter.github.io/scala_school/ko" target="_blank" rel="external">한글 번역</a>도 존재한다. 혹은 Java 경험이 있다면 <a href="http://www.hanbit.co.kr/ebook/look.html?isbn=9788979149678" target="_blank" rel="external">자바 개발자를 위한 함수형 프로그래밍</a>라는 eBook을, JavaScript 경험이 있다면 <a href="http://www.hanbit.co.kr/book/look.html?isbn=978-89-6848-079-9" target="_blank" rel="external">함수형 자바스크립트</a>라는 좋은 책들도 있다.</p>
<h3>2.4. Solution</h3>
<p>다시 도장 이야기로 돌아가서, 이 문제를 해결하기 위해 영후님은 F#이라는 언어의 pipe-forwarding(<code>|&gt;</code>)이라는 연산자를 구현하셨다. <a href="http://undefinedvalue.com/2014/07/13/fs-pipe-forward-operator-swift" target="_blank" rel="external">Swift에서의 pipe-forwarding |&gt;의 구현</a>이라는 글을 읽어보면 구현체와 그 설명이 자세히 나와있다.</p>
<p>도장에서 나온 문제와 일치하지는 않지만 위에 나온 과정들을 종합해보면 이런 예제를 만들 수 있다.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">infix</span> <span class="keyword">operator</span> |&gt;   &#123; <span class="keyword">precedence</span> <span class="number">50</span> <span class="keyword">associativity</span> <span class="keyword">left</span> &#125;</span><br><span class="line"></span><br><span class="line">public <span class="func"><span class="keyword">func</span> |&gt; <span class="generics">&lt;T,U&gt;</span><span class="params">(lhs: T, rhs: T -&gt; U)</span></span> -&gt; <span class="type">U</span> &#123;  </span><br><span class="line">    <span class="keyword">return</span> rhs(lhs)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="func"><span class="keyword">func</span> <span class="title">ifilter</span><span class="generics">&lt;T&gt;</span><span class="params">(closure: T-&gt;Bool)</span></span> -&gt; [<span class="type">T</span>]-&gt;[<span class="type">T</span>] &#123;  </span><br><span class="line">    <span class="keyword">return</span> &#123; <span class="built_in">filter</span>($<span class="number">0</span>, closure) &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="func"><span class="keyword">func</span> <span class="title">imap</span><span class="generics">&lt;T,S&gt;</span><span class="params">(closure: T-&gt;S)</span></span> -&gt; [<span class="type">T</span>]-&gt;[<span class="type">S</span>] &#123;  </span><br><span class="line">    <span class="keyword">return</span> &#123; <span class="built_in">map</span>($<span class="number">0</span>, closure) &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> list = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>]  </span><br><span class="line">         |&gt; ifilter  &#123; $<span class="number">0</span>%<span class="number">2</span> == <span class="number">0</span> &#125;</span><br><span class="line">         |&gt; imap     &#123; $<span class="number">0</span>*<span class="number">2</span> &#125;</span><br><span class="line">         |&gt; imap     &#123; <span class="type">String</span>($<span class="number">0</span>) &#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">println</span>(list) <span class="comment">// ["4", "8"]</span></span><br></pre></td></tr></table></figure>
<h1>3. Accumulator</h1>
<p>누산기(accumulator)는 함수 하나를 리턴하는데, 그 함수는 인자를 하나 받을 때마다 그 값들이 누산된 결과를 리턴한다. 클로저에서 값을 캡처해서 리턴하는 것은 1번 문제에서 했고, 캡처된 값을 변경하도록 하는 것과 파라미터로 정의된 값을 다시 변수로 사용해서 소스코드를 짧게 만들도록 구현하는게 목적이었다.</p>
<h1>4. Jensen's Device</h1>
<p>이번에도 알고리즘 문제가 하나 나왔다. <a href="http://en.wikipedia.org/wiki/Jensen's_Device" target="_blank" rel="external">Jensen's Device</a>라는 문제로 한 변수를 캡처하고 있는 클로저를 계속 이용해서 따로 변수 선언없이 파라미터만으로 문제를 해결하도록하는 문제였다. 인자로 넘길 때 스코프 명시(<code>{}</code>)없이 쓸 수 있도록 해주는 <code>@auto_closure</code>라는 키워드에 대해 배웠다.</p>
<h1>5. Conclusion</h1>
<p>1회의 난이도가 1이었다면 이번 난이도는 10쯤 된다. 다음의 난이도는 얼마나 될지 모르겠다.</p>
<style type="text/css">
blockquote p:first-child { text-align: initial !important; }
blockquote p:last-child { text-align: right; }
</style></div><footer class="post__foot u-cf"><ul class="post__tag u-fl"><li class="post__tag__item"><a href="/blog/tags/osxdev/" class="post__tag__link">osxdev</a></li><li class="post__tag__item"><a href="/blog/tags/swift/" class="post__tag__link">swift</a></li></ul><a href="https://github.com/seoh/blog/tree/master/source/_posts/coding-dojo-2nd.md" class="post__foot-link u-fr">Pull Request</a><a href="https://github.com/seoh/blog/issues/new" class="post__foot-link u-fr">Tell me</a></footer></article><article class="post"><header class="post__head"><time datetime="2014-07-23T15:00:00.000Z" class="post__time">24th Jul, 2014</time><h1 class="post__title"><a href="/blog/2014/07/24/coding-dojo-1st/">Coding Dojo #1 후기</a></h1></header><div class="post__main echo"><p>OSXDev에서 열린 <a href="http://osxdev.org/forum/index.php?threads/swift-%EC%BD%94%EB%94%A9%EB%8F%84%EC%9E%A5-1%ED%9A%8C-%EA%B3%B5%EC%A7%80.367/" target="_blank" rel="external">Coding Dojo</a>에 다녀왔다. 보통 Dojo가 붙은 사이트들을 생각해서 이해하지 못하면 어쩌나 긴장했는데 다행히 난이도는 예상보다 낮았다. 타겟은 &quot;책을 읽었다&quot;와 &quot;이해했다&quot; 사이의 사람이 대상인 것 같다. 그러니까 책은 읽었는데 어떻게 써야할지 감이 안오는 사람들을 위한 '체득'의 시간 정도? 문제를 풀어보고 해석하고의 반복으로 진행되어 네 문제를 풀었다.</p>
<p>진행했던 문제들과 소스보다는 어떤 의도의 문제들이었고 어떤 것을 얻었나를 정리해본다.</p>
<hr>
<h1>1. if문에서의 Optional과 Boolean의 차이</h1>
<p>트위터에 예전에 올라왔던 문제인데 이 문제와 같은 의도였다.</p>
<blockquote class="twitter-tweet" lang="ko"><p>Swift 퀴즈 - 아래 코드의 실행 결과는 무엇일까요? <a href="http://t.co/5wK9hEnILn" target="_blank" rel="external">pic.twitter.com/5wK9hEnILn</a></p>&mdash; 김정현 (@gluebyte) <a href="https://twitter.com/gluebyte/statuses/487490260075417600" target="_blank" rel="external">2014년 7월 11일</a></blockquote>
<script async src="http://platform.twitter.com/widgets.js" charset="utf-8"></script>
<p>팁, 경우에 따라 다르겠지만 Boolean만 처리하지 말고 Optional에서 nil일 때도 처리해주는게 좋다.</p>
<h1>2. switch에서의 pattern matching</h1>
<p>복잡한 케이스에 대해서 switch-case를 단순히 objective-c에서 사용했던 것처럼 쓰거나 if-else문을 반복하는 것보다 tuple로 묶어서 한번에 처리하면 깔끔하고, where절(guard)을 통해 조건을 처리하면 더 깔끔하게 처리된다.</p>
<p>팁, pattern matching에서는 분기가 길어지면 case가 switch문과 거리가 멀어져서 어떤 의미인지 알기 어려운데, 특히 case에 true/false를 사용하는 경우 의미를 바로 알기 어려우므로 enum을 사용해서 의미있는 값을 변수로 만들어서 표현하면 좋다.</p>
<h1>3. 간단한 알고리즘 풀이</h1>
<p>중첩된 for문을 어떻게 사용하는지에 대한 문제. 참고로 100 doors 문제였다.</p>
<h1>4. repeatString</h1>
<p>String에 대한 기본 사용법(concat)과 loop 등을 사용한 정해진 횟수의 문자열 반복.</p>
<hr>
<p>진도가 Control Flow까지만여서 그 안에서만으로 해결할 수 있는 문제들을 짧은 시간 내에 제출하느라 고생하셨으리라 생각된다.</p>
<p>덧 1, 4번 문제의 경우 제약 때문에 함수로 구현했지만 operator overloading을 통해 쓰기 좋게 만들 수도 있다.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="func"><span class="keyword">func</span> <span class="title">repeatString</span><span class="params">(<span class="built_in">count</span> n:Int,string s:String)</span></span> -&gt; <span class="type">String</span> &#123;  </span><br><span class="line">    <span class="keyword">return</span> <span class="type">Array</span>(<span class="built_in">count</span>:n, repeatedValue:s).<span class="built_in">reduce</span>(<span class="string">""</span>,+)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="preprocessor">@infix</span> <span class="func"><span class="keyword">func</span> * <span class="params">(<span class="keyword">left</span>: String, <span class="keyword">right</span>: Int)</span></span> -&gt; <span class="type">String</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> repeatString(<span class="built_in">count</span>: <span class="keyword">right</span>, string: <span class="keyword">left</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="preprocessor">@infix</span> <span class="func"><span class="keyword">func</span> * <span class="params">(<span class="keyword">left</span>: Int, <span class="keyword">right</span>: String)</span></span> -&gt; <span class="type">String</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> repeatString(<span class="built_in">count</span>: <span class="keyword">left</span>, string: <span class="keyword">right</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">println</span>(<span class="string">"a"</span> * <span class="number">2</span>) <span class="comment">// "aa"  </span></span><br><span class="line"><span class="built_in">println</span>(<span class="number">2</span> * <span class="string">"a"</span>) <span class="comment">// "aa"</span></span><br></pre></td></tr></table></figure>
<p>덧 2, swift 프로젝트에서 다른 파일에 구현을 해도 하나로 묶어서 해석하므로 같은 이름의 함수를 구현하면 에러가 난다는 질문이 있었는데, 얼마 전에 추가된 접근자(access control)을 통해 해결할 수 있을 줄 알고 시도해봤지만 안된다. c처럼 static 키워드가 생기거나 다른 방법을 찾아봐야겠다.</p>
</div><footer class="post__foot u-cf"><ul class="post__tag u-fl"><li class="post__tag__item"><a href="/blog/tags/osxdev/" class="post__tag__link">osxdev</a></li><li class="post__tag__item"><a href="/blog/tags/swift/" class="post__tag__link">swift</a></li></ul><a href="https://github.com/seoh/blog/tree/master/source/_posts/coding-dojo-1st.md" class="post__foot-link u-fr">Pull Request</a><a href="https://github.com/seoh/blog/issues/new" class="post__foot-link u-fr">Tell me</a></footer></article><article class="post"><header class="post__head"><time datetime="2014-06-27T15:00:00.000Z" class="post__time">28th Jun, 2014</time><h1 class="post__title"><a href="/blog/2014/06/28/v8-optimization-killers/">V8 Optimization killers</a></h1></header><div class="post__main echo"><blockquote>
<h3>Translation of &quot;<a href="https://github.com/petkaantonov/bluebird/wiki/Optimization-killers" target="_blank" rel="external">Optimization killers</a>&quot; into Korean, under the same license as the original.</h3>
</blockquote>
<h3>도입</h3>
<p>이 문서는 예상보다 훨씬 성능이 떨어지는 코딩을 피하기 위한 조언이 포함되어 있다. 특히 V8(nodejs, Opera, Chromium 등)에서 최적화를 방해하는 패턴에 대한 것이다.</p>
<h3>V8 배경지식 약간</h3>
<p>V8에서는 인터프리터가 없고 2가지 컴파일러가 있다, 일반 컴파일러(generic)와 최적화 컴파일러(optimizing).
즉, JavaScript 코드를 항상 컴파일하고 네이티브로 직접 실행한다는 뜻이다. 이는 빠르다는 뜻이다, 정말? 아니다. 네이티브로 컴파일된 코드라고 해서 성능적으로 큰 의미가 있는 것은 아니다. 단지 인터프리터 과부하를 제거한 것이라 최적화되지 않은 코드는 여전히 느리게 돌아간다.</p>
<p>예를 들어, 일반 컴파일러로 <code>a + b</code>는 다음과 같다.</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mov eax, a  &#10;mov ebx, b  &#10;call RuntimeAdd</span><br></pre></td></tr></table></figure>
<p>위에서 보면 단지 런타임 함수를 호출한다. <code>a</code>와 <code>b</code>가 항상 정수라면 다음과 같이 된다.</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mov eax, a  &#10;mov ebx, b  &#10;add eax, ebx</span><br></pre></td></tr></table></figure>
<p>런타임에서 복잡한 의미가 추가된 스크립트보다 훨씬 빠르게 작동할 것이다.</p>
<p>전자는 일 컴파일러에서 나오는 코드고, 후자는 최적화 컴파일러에서 나오는 코드다. 최적화 컴파일러로 컴파일된 코드는 대충 일반 컴파일러로 생성한 것보다 100배쯤 빠르다. 여기서 잠깐, 그냥 JavaScript로 코딩한다고 최적화된다는 것은 아니다. 많은 패턴들이 있는데, 최적화 컴파일러가 건들지 못하는 관용적인 것들이 있다.</p>
<p>중요한 점은, 이렇게 최적화 제외 코드는 그 함수를 포함하는 전체에 영향을 준다는 것이다. 코드는 한번에 한 함수만 최적화가 되고, 다른 코드가 무엇을 하든 전혀 모르고 있다(현재 최적화하고 있는 함수 내에 인라인된 코드가 아니라면).</p>
<p>이 가이드는 &quot;비최적화&quot;의 함수를 포함해 대부분의 패턴을 다룬다. 최적화 컴파일러가 더 많은 패턴을 인식할 수 있도록 업데이트 될 때 이런 우회 방법들은 불필요해질 것이다.</p>
<p>(본문은 요약)</p>
<h3>주제</h3>
<ol>
<li><a href="#1-_%ED%88%B4%EB%A7%81">툴링</a></li>
<li><a href="#2-_%EB%AF%B8%EC%A7%80%EC%9B%90_%EB%AC%B8%EB%B2%95">미지원 문법</a></li>
<li><a href="#3-_arguments_%EA%B4%80%EB%A6%AC"><code>arguments</code> 관리</a></li>
<li><a href="#4-_switch-case">switch-case</a></li>
<li><a href="#5-_for-in">for-in</a></li>
</ol>
<h3>1. 툴링</h3>
<p>최적화에 영향을 주는지 알아보기 위해 V8의 내부에서 사용하는 플래그를 사용할 수 있다.</p>
<p>HackerNews의 댓글을 보면 플래그 등에 대한 <a href="https://news.ycombinator.com/item?id=7943303" target="_blank" rel="external">추가 설명</a>이 있고, DailyJS.com에서 <a href="http://dailyjs.com/2014/06/26/optimization-killers/" target="_blank" rel="external">요약</a>되어있다.</p>
<h3>2. 미지원 문법</h3>
<p>현재까진 최적화되지 않는 문법</p>
<ul>
<li>제너레이터 함수</li>
<li>for-of를 포함하는 함수</li>
<li>try-catch를 포함하는 함수</li>
<li>try-finally를 포함하는 함수</li>
<li><code>let</code>이나 <code>const</code> 선언을 포함하는 함수</li>
<li><code>__proto__</code>나 <code>get</code>이나 <code>set</code> 선언이 있는 객체 표현식을 포함하는 함수</li>
</ul>
<p>앞으로도 계속 안될 것 같은 문법</p>
<ul>
<li><code>debugger</code>문을 포함하는 함수</li>
<li><code>eval()</code>을 호출하는 함수</li>
<li><code>with</code> 문을 포함하는 함수</li>
</ul>
<p><code>try-catch-finally</code>에 대해서는 다음과 같이 함수로 뽑아서 우회 가능</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> errorObject = &#123;value: <span class="literal">null</span>&#125;;  </span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">tryCatch</span>(<span class="params">fn, ctx, args</span>) </span>&#123;  </span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> fn.apply(ctx, args);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">catch</span>(e) &#123;</span><br><span class="line">        errorObject.value = e;</span><br><span class="line">        <span class="keyword">return</span> errorObject;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> result = tryCatch(mightThrow, <span class="keyword">void</span> <span class="number">0</span>, [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]);  </span><br><span class="line"><span class="comment">//Unambiguously tells whether the call threw</span></span><br><span class="line"><span class="keyword">if</span>(result === errorObject) &#123;  </span><br><span class="line">    <span class="keyword">var</span> error = errorObject.value;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;  </span><br><span class="line">    <span class="comment">//result is the returned value</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3>3. <code>arguments</code> 관리</h3>
<h4>3.1. <code>arguments</code>를 함수 내에서 사용하면서 파라미터로 넘겨준 변수에 다른 값을 넣을 때</h4>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">defaultArgsReassign</span>(<span class="params">a, b</span>) </span>&#123;  </span><br><span class="line">     <span class="keyword">if</span> (<span class="built_in">arguments</span>.length &lt; <span class="number">2</span>) b = <span class="number">5</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>우회</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">reAssignParam</span>(<span class="params">a, b_</span>) </span>&#123;  </span><br><span class="line">    <span class="keyword">var</span> b = b_;</span><br><span class="line">    <span class="comment">//unlike b_, b can safely be reassigned</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">arguments</span>.length &lt; <span class="number">2</span>) b = <span class="number">5</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>혹은</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">reAssignParam</span>(<span class="params">a, b</span>) </span>&#123;  </span><br><span class="line">    <span class="keyword">if</span> (b === <span class="keyword">void</span> <span class="number">0</span>) b = <span class="number">5</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4>3.2. <code>arguments</code>를 외부로 노출</h4>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">leaksArguments1</span>(<span class="params"></span>) </span>&#123;  </span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">arguments</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">leaksArguments2</span>(<span class="params"></span>) </span>&#123;  </span><br><span class="line">    <span class="keyword">var</span> args = [].slice.call(<span class="built_in">arguments</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">leaksArguments3</span>(<span class="params"></span>) </span>&#123;  </span><br><span class="line">    <span class="keyword">var</span> a = <span class="built_in">arguments</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> a;</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>우회</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">doesntLeakArguments</span>(<span class="params"></span>) </span>&#123;  </span><br><span class="line">    <span class="keyword">var</span> args = <span class="keyword">new</span> <span class="built_in">Array</span>(<span class="built_in">arguments</span>.length);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; args.length; ++i) &#123;</span><br><span class="line">        args[i] = <span class="built_in">arguments</span>[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> args;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>혹은 빌드 과정에서 매크로를 사용해 치환하는 방법</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">doesntLeakArguments</span>(<span class="params"></span>) </span>&#123;  </span><br><span class="line">    INLINE_SLICE(args, <span class="built_in">arguments</span>);</span><br><span class="line">    <span class="keyword">return</span> args;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>bluebird에서 사용하는 방법</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">doesntLeakArguments</span>(<span class="params"></span>) </span>&#123;  </span><br><span class="line">    <span class="keyword">var</span> $_len = <span class="built_in">arguments</span>.length;<span class="keyword">var</span> args = <span class="keyword">new</span> <span class="built_in">Array</span>($_len); <span class="keyword">for</span>(<span class="keyword">var</span> $_i = <span class="number">0</span>; $_i &lt; $_len; ++$_i) &#123;args[$_i] = <span class="built_in">arguments</span>[$_i];&#125;</span><br><span class="line">    <span class="keyword">return</span> args;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4>3.3. arguments에 값을 넣을 때</h4>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">assignToArguments</span>(<span class="params"></span>) </span>&#123;  </span><br><span class="line">    <span class="built_in">arguments</span> = <span class="number">3</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">arguments</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>이것만 사용</p>
<ul>
<li><code>arguments.length</code></li>
<li>유효한 인덱스 <code>i</code>를 통해 <code>arguments[i]</code></li>
<li><code>.length</code>없이 직접 사용하지마라. <code>x.apply(y, arguments)</code> 이건 괜찮다. <code>.slice</code>와 <code>Function#apply</code>는 특별하니까</li>
</ul>
<h3>4. switch-case</h3>
<p>case 조건이 128개까지는 괜찮고 초과하면 최적화를 못한다.</p>
<h3>5. for-in</h3>
<h4>5.1. key가 지역변수가 아닐 때</h4>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">nonLocalKey1</span>(<span class="params"></span>) </span>&#123;  </span><br><span class="line">    <span class="keyword">var</span> obj = &#123;&#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">var</span> key <span class="keyword">in</span> obj);</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> key;</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>혹은</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> key;  </span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">nonLocalKey2</span>(<span class="params"></span>) </span>&#123;  </span><br><span class="line">    <span class="keyword">var</span> obj = &#123;&#125;</span><br><span class="line">    <span class="keyword">for</span>(key <span class="keyword">in</span> obj);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>외부로 노출하거나 해당 루프의 지역변수가 아니면 불가능.</p>
<h4>5.2. 순환하려는 객체가 &quot;simple enumerable&quot;이 아닐 때</h4>
<h5>5.2.1. &quot;hash table mode&quot;의 객체</h5>
<p>생성자 밖에서 동적으로 프로퍼티들을 추가하거나 삭제할 때 hash table mode가 된다.</p>
<h5>5.2.2. 프로토타입 체인에서 enumerable 프로퍼티를 가질 때</h5>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Object</span>.prototype.fn = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;&#125;;</span><br></pre></td></tr></table></figure>
<p>이렇게 하면 모든 객체에서 for-in이 최적화되지 못한다. <code>Object.create(null)</code>만 예외. 필요하면 <code>Object.defineProperty</code>로 enumerable하지 않은 프로퍼티를 만들 수 있지만 비추. (역주, 이유는 나와있지 않음)</p>
<h5>5.2.3. 배열의 인덱스를 키값으로 사용할 때</h5>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">iteratesOverArray</span>(<span class="params"></span>) </span>&#123;  </span><br><span class="line">    <span class="keyword">var</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> index <span class="keyword">in</span> arr) &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>배열을 순환하고 싶으면 <code>Object.keys</code>를 사용하는게 좋고, 프로토타입 체인 전체를 돌고 싶다면 다음과 같이 key값을 따로 모아서 처리한다.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">inheritedKeys</span>(<span class="params">obj</span>) </span>&#123;  </span><br><span class="line">    <span class="keyword">var</span> ret = [];</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">var</span> key <span class="keyword">in</span> obj) &#123;</span><br><span class="line">        ret.push(key);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><footer class="post__foot u-cf"><ul class="post__tag u-fl"><li class="post__tag__item"><a href="/blog/tags/V8/" class="post__tag__link">V8</a></li><li class="post__tag__item"><a href="/blog/tags/anti-pattern/" class="post__tag__link">anti-pattern</a></li><li class="post__tag__item"><a href="/blog/tags/optimize/" class="post__tag__link">optimize</a></li></ul><a href="https://github.com/seoh/blog/tree/master/source/_posts/v8-optimization-killers.md" class="post__foot-link u-fr">Pull Request</a><a href="https://github.com/seoh/blog/issues/new" class="post__foot-link u-fr">Tell me</a></footer></article><article class="post"><header class="post__head"><time datetime="2014-06-24T15:00:00.000Z" class="post__time">25th Jun, 2014</time><h1 class="post__title"><a href="/blog/2014/06/25/build-swift-file-on-sublime-text/">Sublime Text에서 swift파일 빌드하기</a></h1></header><div class="post__main echo"><h4>조건</h4>
<ul>
<li>Sublime Text와 <a href="https://sublime.wbond.net/installation" target="_blank" rel="external">Package Control</a>이 설치되어 있을 것</li>
<li>Swift 개발 환경이 설정되어있을 것</li>
</ul>
<h4>순서</h4>
<ul>
<li>Package Control을 통해 Swift 패키지 설치</li>
<li>Tools &gt; Build System &gt; New Build System... 에서 다음과 같이 입력한다.</li>
</ul>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    "<span class="attribute">cmd</span>": <span class="value">[<span class="string">"swift"</span>, <span class="string">"-i"</span>, <span class="string">"$file"</span>]</span>,</span><br><span class="line">    "<span class="attribute">selector</span>": <span class="value"><span class="string">"source.swift"</span></span><br><span class="line"></span>&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>빌드 정보를 저장한다. (예, <code>Swift.sublime-build</code>)</li>
<li>cmd + B로 빌드한다.</li>
</ul>
<p><img src="/blog/images/build-swift-file-on-sublime-text/swift-sublime-build.png" alt=""></p>
<h4>부연 설명</h4>
<p>Swift 패키지를 설치하면 문법 강조는 기본으로 지원하고 각종 Snippet을 지원해서 Xcode만큼은 아니더라도 편하게 작성할 수 있다.</p>
<p><img src="/blog/images/build-swift-file-on-sublime-text/swift-sublime-snippet.png" alt=""></p>
<p><a href="https://github.com/quiqueg/Swift-Sublime-Package" target="_blank" rel="external">Swift 패키지 프로젝트</a>에서 패키지 파일들을 확인하면 보다 자세한 정보를 알 수 있다.</p>
</div><footer class="post__foot u-cf"><ul class="post__tag u-fl"><li class="post__tag__item"><a href="/blog/tags/Sublime-Text/" class="post__tag__link">Sublime Text</a></li><li class="post__tag__item"><a href="/blog/tags/swift/" class="post__tag__link">swift</a></li></ul><a href="https://github.com/seoh/blog/tree/master/source/_posts/build-swift-file-on-sublime-text.md" class="post__foot-link u-fr">Pull Request</a><a href="https://github.com/seoh/blog/issues/new" class="post__foot-link u-fr">Tell me</a></footer></article><article class="post"><header class="post__head"><time datetime="2014-06-22T15:00:00.000Z" class="post__time">23rd Jun, 2014</time><h1 class="post__title"><a href="/blog/2014/06/23/add-current-repository-info-to-shell/">쉘에서 현재 위치의 repository 정보 추가하기</a></h1></header><div class="post__main echo"><h1>GitHub에서 공개한 Bash/Zsh/Tcsh용 Prompt</h1>
<ul>
<li>GitHub: <a href="https://github.com/git/git/blob/master/contrib/completion/" target="_blank" rel="external">git / contrib / completion /</a></li>
<li>기본 구조: (&lt;브랜치 이름&gt;)</li>
<li>설명: <a href="http://code-worrier.com/blog/git-branch-in-bash-prompt/" target="_blank" rel="external">Put Your Git Branch in Your Bash Prompt</a></li>
</ul>
<h3>한줄 추가로 현재 브랜치 표시</h3>
<p>기본 구조: (&lt;브랜치 이름&gt;)
설명: <a href="http://ccoroom.tumblr.com/post/14261727932/git" target="_blank" rel="external">명령 프롬프트에 현재 Git 브랜치 표시하기</a></p>
<h3>현재 브랜치와 컬러 표시</h3>
<p>기본 구조: (&lt;브랜치 이름&gt;)
설명: <a href="http://blog.outsider.ne.kr/616" target="_blank" rel="external">bash 프롬프트에 Git와 Mercurial의 branch를 표시하기</a>
비고: Mercurial도 가능.</p>
<h3>vcprompt를 이용한 프롬프트</h3>
<p>설명: <a href="http://blog.outsider.ne.kr/737" target="_blank" rel="external">vcprompt를 이용해서 bash 프롬프트에 VCS 정보 표시하기</a>
기본 구조: (&lt;형상관리 이름&gt;:&lt;브랜치 이름&gt; )
비고: VCS 이름, commit hash, branch, revision, modified file, not-added 등 각종 변수 지원</p>
<h3>Bash prompot에서 Git 정보 보기</h3>
<p>GitHub: <a href="https://github.com/magicmonty/bash-git-prompt" target="_blank" rel="external">magicmonty/bash-git-prompt</a>
기본 구조: (&lt;브랜치 이름&gt; &lt;브랜치 상태&gt;|&lt;로컬 상태&gt;)
설명: <a href="http://resoneit.blogspot.kr/2014/01/bash-git.html" target="_blank" rel="external">리눅스 bash shell에서 git 상태 정보 보기</a>
비고: add, conflict, modified, non-added, stashed, yet-pushed, yet-pulled 상태의 숫자 등 표시
결론
vcprompt를 이용했다. 이유는 homebrew로 설치 가능한 유일한 방법이라 설치하기가 쉬워서. 이전의 설정은 다음과 같다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> PS1=<span class="string">"<span class="variable">$C_LIGHTGRAY</span>(\t)<span class="variable">$C_RESET</span> \W \u <span class="variable">$C_GRAY</span>$ <span class="variable">$C_RESET</span>"</span></span><br></pre></td></tr></table></figure>
<p>즉, ((시간) 사용자 현재디렉토리 $ )의 구조였다. 여기에서 vcprompt를 추가해서</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">VC=<span class="string">" \$(vcprompt -f "</span><span class="variable">$C_BG_GREEN</span>%n:%b<span class="variable">$C_BG_RED</span>%m%u<span class="variable">$C_RESET</span><span class="string">")"</span>  </span><br><span class="line"><span class="built_in">export</span> PS1=<span class="string">"<span class="variable">$C_LIGHTGRAY</span>(\t)<span class="variable">$C_RESET</span> \W \u<span class="variable">$VC</span> <span class="variable">$C_GRAY</span>$ <span class="variable">$C_RESET</span>"</span></span><br></pre></td></tr></table></figure>
<p>((시간) 사용자 현재디렉토리 형상관리정보 $)의 구조로 변경했다.</p>
<p><img src="/blog/images/add-current-repository-info-to-shell/shell.png" alt="">
위와 같이 전/후가 변경되었다.</p>
<p>사용된 색상관련 변수는 <a href="http://blog.saltfactory.net/99" target="_blank" rel="external">터미널에서 프롬프트(Prompt)에 나타나는 정보와 색상 변경하기</a>를 참고하면 된다.</p>
</div><footer class="post__foot u-cf"><ul class="post__tag u-fl"><li class="post__tag__item"><a href="/blog/tags/shell/" class="post__tag__link">shell</a></li><li class="post__tag__item"><a href="/blog/tags/vcprompt/" class="post__tag__link">vcprompt</a></li></ul><a href="https://github.com/seoh/blog/tree/master/source/_posts/add-current-repository-info-to-shell.md" class="post__foot-link u-fr">Pull Request</a><a href="https://github.com/seoh/blog/issues/new" class="post__foot-link u-fr">Tell me</a></footer></article><article class="post"><header class="post__head"><time datetime="2012-11-17T11:50:00.000Z" class="post__time">17th Nov, 2012</time><h1 class="post__title"><a href="/blog/2012/11/17/after-coursera-fppis-and-test/">Coursera - FPPiS 후기, 그리고 테스트</a></h1></header><div class="post__main echo"><p>coursera.org의 functional programming principle in scala의 진행이 끝났다. functional programming이라는 생소한 개념을 배우면서 재미있기도 했고, 강의를 시작하기 직전에 봤던 '자바 개발자를 위한 함수형 프로그래밍'를 읽으면서 제대로 알지 못했던 개념을 좀 더 확실하게 배웠다. 물론 강의와 서적 모두 '입문'에 대한 것이라 의미에 대해 알려면 더 많은 경험이 필요하겠고, 서적과 강의가 지향하는 바가 조금 달라서 내용도 다르지만 서적을 보면서 제대로 이해하지 못했던 개념을 강의를 보면서 이해하는데 도움이 되었고 기초가 있는 상태에서 다시 서적을 읽으면 더 이해가 잘 될 것 같다.</p>
<p>사실 강의를 읽으면서 도움이 된 것은 functional programming에 대한 이해보다 다른 것이다. 물론 functional programming에 대한 기초를 쌓는데도 무척 도움이 되었지만, 그것보다 과제를 진행하는데 있어서 '테스트'의 중요성에 대한 인식이 생겼다.</p>
<p>과제를 진행하는 방식은 이렇다.</p>
<ol>
<li>테스트 케이스가 주어진다.</li>
<li>작성해야하는 로직이 제외된 코드가 주어진다.</li>
<li>단계별로 로직을 구현하면서 테스트를 통해 작성된 로직이 유효한지 확인한다.</li>
<li>이전 단계에서 구현한 것을 기반으로 다음 단계의 로직을 작성한다.</li>
</ol>
<p>물론 주어진 테스트 케이스들 중에서 좋은 테스트 케이스만 있는 것이 아니다. 스펙에서 요구되었지만 테스트에서 확인하지 않은 케이스(정렬된 배열을 가져와야하는데 그 종류와 갯수만 확인하는 경우)는 다음 단계의 테스트를 통과하지 못한다. 그럴 경우에는 테스트에 성공한 코드로 돌아가서 수정을 해야하므로 좋은 테스트라고 볼 수 없다. 이런 식으로 좋은 테스트가 적성되어있는 경우에는 그 테스트를 통과하면 다시 그 코드를 수정할 필요가 없고, 성능상의 문제가 있는 경우에는 그 코드를 수정하고 다시 테스트를 통과하면 다른 코드들을 건들이지 않아도 된다.</p>
<p>여기에 대한 전제가 중요하긴 하다. 앞서 이야기했듯이 '좋은(명확한) 테스트가 작성되어 있을 것', 그리고 '확실히 단계별로 구분된 설계가 있을 것'이다. 이 전제들이 참 어렵지만, 반대로 생각하면 이 전제들이 확실한 경우가 있다. 바로 내가 겪었던 것과 같이 '과제'를 작성하는 경우다. 커다란 과제가 주어졌을 경우에 어디서부터 어떻게 접근해야할지 명세서를 봐도 막막한 경우가 있는데 그런 경우에 bottom-up으로 제대로 된 설계에 따라 테스트를 하나씩 거치면서 확실히 눈에 보이는 진척을 확인할 수 있다. 물론 실무에 적용하려면 저 전제들을 만족하기 참 힘들겠지만 말이다. 혹은 퍼포먼스의 이슈가 없거나 종속성이 적은 코드들의 경우에 신입사원들에게 연습시키는 용도로는 확실할 수 있다.</p>
<p>예전에 일하던 회사에서 '시켜서' 억지로 작성한 테스트들이 떠오르며 (사실 잘 떠오르지도 않지만) 부끄러워졌다. 사실 TDD라고 하지만 아직도 TDD가 뭔지 잘 모르겠고, 이해하지 못한 상태에서 작성한 테스트들은 당연히 좋은 테스트일리가 없었다. 이렇게 실무에서 어떻게 테스트를 더 잘 적용시킬 수 있는지에 대해 듣고 싶어서 저번달에 모 컨퍼런스에 다녀왔는데 그냥 '테스트는 의지를 가지고 해야 한다.'라는 말만 반복해서 하더라. 하긴 누군가가 말해줘도 그걸 체득하기는 어렵다. 계기와 경험이 중요한데 나는 일단 이 강의라는 계기를 얻었으니 앞으로 경험을 쌓도록 노력해야지.</p>
<p>참고로 80점 만점에서 60%(48점)만 얻으면 인증을 얻는데 과제를 너무 늦게 시작하는 바람에 1주차에 80% 감점을 받고 시작한 것을 합쳐서 69점으로 통과했다. 만점을 목표로 한 것에 비하면 부끄럽지만 인증을 받은 것만으로도 일단은 만족. 그리고 스칼라 스터디에 한번 참여해보고 싶었는데 영어 실력이 부족하여 참여할만큼 이해한 강의가 없어서 한번도 참여를 못한 것 두가지가 아쉽다.</p>
</div><footer class="post__foot u-cf"><ul class="post__tag u-fl"><li class="post__tag__item"><a href="/blog/tags/Scala/" class="post__tag__link">Scala</a></li><li class="post__tag__item"><a href="/blog/tags/coursera/" class="post__tag__link">coursera</a></li><li class="post__tag__item"><a href="/blog/tags/test/" class="post__tag__link">test</a></li></ul><a href="https://github.com/seoh/blog/tree/master/source/_posts/after-coursera-fppis-and-test.md" class="post__foot-link u-fr">Pull Request</a><a href="https://github.com/seoh/blog/issues/new" class="post__foot-link u-fr">Tell me</a></footer></article><article class="post"><header class="post__head"><time datetime="2012-10-09T01:21:00.000Z" class="post__time">9th Oct, 2012</time><h1 class="post__title"><a href="/blog/2012/10/09/getting-cozy-with-underscore-js/">underscore.js로 편해지자</a></h1></header><div class="post__main echo"><blockquote>
<h2>Translation of &quot;<a href="http://code.tutsplus.com/tutorials/getting-cozy-with-underscore-js--net-24581" target="_blank" rel="external">Getting Cozy With Underscore.js</a>&quot; into Korean, under the same license as the original.</h2>
</blockquote>
<p>들어가기 전에, <a href="http://almostobsolete.net/talks/functionaljs/" target="_blank" rel="external">functional javascript</a> 자바스크립트의 함수형 프로그래밍에 대한 간략한 소개가 있는 슬라이드. 함수형 프로그래밍에 개념과 underscore의 컨셉을 이해하는데 도움이 된다.</p>
<hr>
<h1>Underscore.js와 만나다</h1>
<p>그래서 Underscore가 정확히 뭐하는건데?</p>
<blockquote>
<p>Underscore는 Prototype.js(혹은 Ruby)처럼 기본 JavaScript 객체들을 확장하지 않고 함수형 프로그래밍을 지원할 수 있는 유용한 JavaScript Library이다.</p>
</blockquote>
<p>Python이나 Ruby로 작업할 때 더 좋은 점은 훨씬 쉽게 쓸 수 있는 <code>map</code>같은 멋진 기본함수들이 있다는 것이다. 슬프게도 JavaScript의 현재 버전에서는 그런 native로 제공되는 것들이 꽤나 부실하다. 위에서 읽은 것처럼, Underscore.js는 단지 4kb라는 터무니없는 용량의 좀 멋진 JavaScript Library다.</p>
<hr>
<h2>Underscore in Action</h2>
<p>&quot;라이브러리 이야기는 충분히 많이 들었다&quot;, 라는 말할지도 모른다. 맞다, 하지만 일단 한번 보자. 임의의 시험점수 배열에서 90점 넘는 리스트가 필요하면 보통은 이렇게 짤 것이다.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> scores = [<span class="number">84</span>, <span class="number">99</span>, <span class="number">91</span>, <span class="number">65</span>, <span class="number">87</span>, <span class="number">55</span>, <span class="number">72</span>, <span class="number">68</span>, <span class="number">95</span>, <span class="number">42</span>],</span><br><span class="line">topScorers = [], scoreLimit = <span class="number">90</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (i=<span class="number">0</span>; i&lt;=scores.length; i++)</span><br><span class="line">&#123;</span><br><span class="line">   <span class="keyword">if</span> (scores[i]&gt;scoreLimit)</span><br><span class="line">   &#123;</span><br><span class="line">      topScorers.push(scores[i]);</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(topScorers);</span><br></pre></td></tr></table></figure>
<p>꽤 깔끔하고 심지어 최적화도 있는데, 내가 하려는 것보다는 좀 길다. underscore로 하면 이렇게 된다.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> scores = [<span class="number">84</span>, <span class="number">99</span>, <span class="number">91</span>, <span class="number">65</span>, <span class="number">87</span>, <span class="number">55</span>, <span class="number">72</span>, <span class="number">68</span>, <span class="number">95</span>, <span class="number">42</span>],</span><br><span class="line">topScorers = [], scoreLimit = <span class="number">90</span>;</span><br><span class="line"></span><br><span class="line">topScorers = _.select(scores, <span class="function"><span class="keyword">function</span>(<span class="params">score</span>)</span>&#123; <span class="keyword">return</span> score &gt; scoreLimit;&#125;);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(topScorers);</span><br></pre></td></tr></table></figure>
<p>넌 어떤지 모르겠지만 난 좀 너드같다. 저기있는 코드 굉장히 간결하고 읽기 좋다.</p>
<h2>괜찮긴한데 진짜 필요해?</h2>
<p>모든건 뭘 하려고 하는지에 달렸다. 단지 DOM 다루는데 사용을 제한한다면 jQuery로 원하는건 대부분 할 수 있다. 반대로, DOM이랑 관련없거나 좀 복잡한 MVC나 front-end 코드들이라면 underscore는 확실히 괜찮다. ECMA 스펙에 맞춰서 천천히 라이브러리들의 기능이 업데이트되는 동안에, 모든 브라우져에서 돌아가는건 가능하지도 않고 여러 브라우저들에서 돌아가게 하는 것도 또다른 악몽이다. underscore는 어디서든 작동하도록 좋은 추상화를 제공한다. 그리고 퍼포먼스를 중시하는 사람이거나 그래야하는 사람이면 underscore는 가능한 native 뒤에 구현된거라 가능한 최적화된 성능을 보장한다.</p>
<h2>시작해보자</h2>
<blockquote>
<p><a href="http://underscorejs.org/docs/underscore.html" target="_blank" rel="external">여기</a>서 소스를 가져다 넣기만 하면 페이지는 잘 돌아간다.</p>
</blockquote>
<p>적용시키는데 뭔가 큰 작업을 기대했으면 꽤나 실망할꺼다. 그냥 <a href="http://underscorejs.org/docs/underscore.html" target="_blank" rel="external">여기</a>에서 소스를 가져다 넣기만 하면 페이지는 잘 돌아간다. underscore는 global 영역에서 단일 객체로 만들어지고 모든 기능을 한다. 이 객체는 underscore 문자, _로 불린다. 흥미롭게도 jQuery가 dollar 문자($)로 돌아가는 것과 매우 비슷해 보인다. 또 jQuery처럼 충돌을 피하려면 다른 문자로 쓸 수도 있다.</p>
<h2>함수형? 아니면 객체지향?</h2>
<p>라이브러리의 공식적인 광고에는 함수형 프로그래밍 지원이라고 써있는데, 실제로 쓰는 다른 방법도 있다. 저 위에서 썼던 예제를 가져와보면</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> scores = [<span class="number">84</span>, <span class="number">99</span>, <span class="number">91</span>, <span class="number">65</span>, <span class="number">87</span>, <span class="number">55</span>, <span class="number">72</span>, <span class="number">68</span>, <span class="number">95</span>, <span class="number">42</span>], topScorers = [], scoreLimit = <span class="number">90</span>;</span><br><span class="line"></span><br><span class="line">topScorers = _.select(scores, <span class="function"><span class="keyword">function</span>(<span class="params">score</span>)</span>&#123; <span class="keyword">return</span> score &gt; scoreLimit;&#125;);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(topScorers);</span><br></pre></td></tr></table></figure>
<p>위의 방법은 함수형이나 절차지향적인 접근이다. 또 더 직관적이며 아마 더 확실하게 객체지향적으로 사용할 수도 있다.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> scores = [<span class="number">84</span>, <span class="number">99</span>, <span class="number">91</span>, <span class="number">65</span>, <span class="number">87</span>, <span class="number">55</span>, <span class="number">72</span>, <span class="number">68</span>, <span class="number">95</span>, <span class="number">42</span>], topScorers = [], scoreLimit = <span class="number">90</span>;</span><br><span class="line"></span><br><span class="line">topScorers = _(scores).select(<span class="function"><span class="keyword">function</span>(<span class="params">score</span>)</span>&#123; <span class="keyword">return</span> score &gt; scoreLimit;&#125;);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(topScorers);</span><br></pre></td></tr></table></figure>
<p>실제로 '정답'이라는건 없지만, jQuery식으로 method 뒤에 chainging을 할 수 있다는 것을 알아두라.</p>
<h2>기능을 확인해보자</h2>
<p>underscore는 기능 자체의 숫자보다 많은 60개보다 조금 넘는 함수를 지원한다. 돌아가는 함수들을 그룹으로 다음과 같이 분류할 수 있다.</p>
<ul>
<li>Collections</li>
<li>Arrays</li>
<li>Objects</li>
<li>Functions</li>
<li>Utilities</li>
</ul>
<p>각각 뭘 하는지를 보고, 가능하면 섹션에서 한두개쯤 적용해보겠다.</p>
<h2>Collections</h2>
<p>connection은 배열이나 객체가 될 수 있고, 의미상으로 말하자면 자바스크립트에서의 (객체와 배열이)혼합된 배열이다. underscore는 collections에서 돌아가는 많은 method들을 제공한다. 위에서 이미 <code>select</code>를 봤다. 여기 더 쓸만한게 하나 있다.</p>
<h3>Pluck</h3>
<p>key와 value 쌍으로 이루어진 깔끔하고 짧은 배열이 있는데 여기에서 특정 속성을 추출하려고 한다. underscore로는 아주 쉽다.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> Tuts = [&#123;name : <span class="string">'NetTuts'</span>, niche : <span class="string">'Web Development'</span>&#125;, &#123;name : <span class="string">'WPTuts'</span>, niche : <span class="string">'WordPress'</span>&#125;, &#123;name : <span class="string">'PSDTuts'</span>, niche : <span class="string">'PhotoShop'</span>&#125;, &#123;name : <span class="string">'AeTuts'</span>, niche : <span class="string">'After Effects'</span>&#125;];</span><br><span class="line"><span class="keyword">var</span> niches = _.pluck(Tuts, <span class="string">'niche'</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(niches);</span><br><span class="line"></span><br><span class="line"><span class="comment">// ["Web Development", "WordPress", "PhotoShop", "After Effects"]</span></span><br></pre></td></tr></table></figure>
<p><code>pluck</code>을 쓰면 객체나 배열을 훑는 것만큼 속성을 뽑아내는 것은 간단하다. 각 사이트들이 분야(niche)에 속하는지 추출해봤다.</p>
<h3>Map</h3>
<p>map은 collection으로부터 함수를 통해 각 요소들을 바뀐 배열을 만든다. 앞에서 있던 예제에서 조금 더해봤다.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> Tuts = [&#123;name : <span class="string">'NetTuts'</span>, niche : <span class="string">'Web Development'</span>&#125;, &#123;name : <span class="string">'WPTuts'</span>, niche : <span class="string">'WordPress'</span>&#125;, &#123;name : <span class="string">'PSDTuts'</span>, niche : <span class="string">'PhotoShop'</span>&#125;, &#123;name : <span class="string">'AeTuts'</span>, niche : <span class="string">'After Effects'</span>&#125;];</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> names = _(Tuts).pluck(<span class="string">'name'</span>).map(<span class="function"><span class="keyword">function</span> (<span class="params">value</span>)</span>&#123;<span class="keyword">return</span> value + <span class="string">'+'</span>&#125;);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(names);</span><br><span class="line"></span><br><span class="line"><span class="comment">// ["NetTuts+", "WPTuts+", "PSDTuts+", "AeTuts+"]</span></span><br></pre></td></tr></table></figure>
<p>이름 끝에 +를 붙이도록 해서, 추출된 배열에는 +가 추가되어있다. 간단한 연쇄(method chaining; 여기에서는 pluck+map)를 하는데 제한은 없다. 지나가는 값들을 원하는데로 다 바꿀 수 있다.</p>
<h3>All</h3>
<p><code>all</code>은 collection 속의 모든 값들이 어떤 기준에 만족하는지 확인하는데 매우 유용하다. 예를 들어, 학생이 모든 과목에서 통과했는지 확인해보자.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> Scores = [<span class="number">95</span>, <span class="number">82</span>, <span class="number">98</span>, <span class="number">78</span>, <span class="number">65</span>];</span><br><span class="line"><span class="keyword">var</span> hasPassed = _(Scores).all(<span class="function"><span class="keyword">function</span> (<span class="params">value</span>)</span>&#123;<span class="keyword">return</span> value&gt;<span class="number">50</span>; &#125;);</span><br><span class="line"><span class="built_in">console</span>.log(hasPassed);</span><br><span class="line"><span class="comment">// true</span></span><br></pre></td></tr></table></figure>
<h2>Arrays</h2>
<p>underscore에만 있는 배열을 다루는 함수들이 굉장히 평이 좋은데, 다른 언어에 비해 JavaScript는 배열을 다루는 함수가 거의 없어서다.</p>
<h3>Uniq</h3>
<p>이 method는 기본적으로 배열을 읽어서 중복값을 제거하고 유일한 값들만 돌려준다.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> uniqTest = _.uniq([<span class="number">1</span>,<span class="number">5</span>,<span class="number">4</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">2</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">3</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">1</span>]);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(uniqTest);</span><br><span class="line"></span><br><span class="line"><span class="comment">// [1, 5, 4, 2, 3]</span></span><br></pre></td></tr></table></figure>
<p>거대한 데이터들을 추려서 중복값을 제거하는데 무척 편하다. 원래 배열의 순서를 유지하기 때문에 중복값 중 첫번째 값이 나온다는걸 명심하자.</p>
<h3>Range</h3>
<p>어떤 '범위'나 숫자들의 리스트를 만들 때 무척 편하다. 빠르게 예제를 보자</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> tens = _.range(<span class="number">0</span>, <span class="number">100</span>, <span class="number">10</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(tens);</span><br><span class="line"></span><br><span class="line"><span class="comment">// [0, 10, 20, 30, 40, 50, 60, 70, 80, 90]</span></span><br></pre></td></tr></table></figure>
<p>파라미터는 순서대로 시작하는 값, 끝나는 값, 그리고 차이값(step)다. 감소하는 범위를 만들고 싶으면 음수의 차이값을 쓰면 된다.</p>
<h3>Intersection</h3>
<p>이 method는 각 배열들을 두 배열씩 비교해서 같은 모든 배열에 있는 값들의 배열을 돌려준다. 집합론에서의 교집합같은 것이다. 위에서 나왔던 예제를 확장해서 이게 어떻게 돌아가는지 보자.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> tens = _.range(<span class="number">0</span>, <span class="number">100</span>, <span class="number">10</span>), eights = _.range(<span class="number">0</span>, <span class="number">100</span>, <span class="number">8</span>), fives = _.range(<span class="number">0</span>, <span class="number">100</span>, <span class="number">5</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> common = _.intersection(tens, eights, fives );</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(common);</span><br><span class="line"></span><br><span class="line"><span class="comment">// [0, 40, 80]</span></span><br></pre></td></tr></table></figure>
<p>쉽지 않나? 비교할 배열들만 써놓으면 underscroe가 나머지는 해준다.</p>
<h2>Objects</h2>
<p><em>is</em> 메소드들은 뭔가를 확인하는데 쓰일꺼라 예상할 수 있고(예를 들어 isEmpty, isEqual 등), underscore는 객체를 복사하거나 확장하거나 기타 등등을 다루는 여러 method들을 제공한다.</p>
<h3>Keys and Values</h3>
<p>커다락 객체에서 key들만 필요하거나 value들만 필요하면? 쉽게 가져올 수 있다.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> Tuts = &#123; NetTuts : <span class="string">'Web Development'</span>,  WPTuts : <span class="string">'WordPress'</span>,  PSDTuts : <span class="string">'PhotoShop'</span>, AeTuts : <span class="string">'After Effects'</span>&#125;;</span><br><span class="line"><span class="keyword">var</span> keys = _.keys(Tuts), values = _.values(Tuts);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(keys + values);</span><br><span class="line"><span class="comment">// NetTuts,WPTuts,PSDTuts,AeTutsWeb Development,WordPress,PhotoShop,After Effects</span></span><br></pre></td></tr></table></figure>
<h3>Defaults</h3>
<p>기본으로 사용해야하는 값들과 함께 객체를 만드는데 꽤 유용하다.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> tuts = &#123; NetTuts : <span class="string">'Web Development'</span>&#125;;</span><br><span class="line"><span class="keyword">var</span> defaults = &#123; NetTuts : <span class="string">'Web Development'</span>, niche: <span class="string">'Education'</span>&#125;;</span><br><span class="line">_.defaults(tuts, defaults);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(tuts);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Object &#123; NetTuts="Web Development", niche="Education"&#125;</span></span><br></pre></td></tr></table></figure>
<h2>Functions</h2>
<p>좀 이상하게 들리지만, underscore는 함수에서 돌아가는 함수들을 갖고 있다. 함수들의 대부분은 설명하기 복잡한 것들이어서 제일 간단한 것을 가져왔다.</p>
<h3>Bind</h3>
<p><code>this</code>는 JavaScript에서 설명하기 힘든 부분이고 많은 개발자들을 멘붕하게 만든다. 이 method는 그나마 건들기 쉽게 해준다.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> o = &#123; greeting: <span class="string">"Howdy"</span> &#125;,</span><br><span class="line">    f = <span class="function"><span class="keyword">function</span>(<span class="params">name</span>) </span>&#123; <span class="keyword">return</span> <span class="keyword">this</span>.greeting +<span class="string">" "</span>+ name; &#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> greet = _.bind(f, o);</span><br><span class="line"></span><br><span class="line">greet(<span class="string">"Jess"</span>)</span><br></pre></td></tr></table></figure>
<p>헷갈려서 계속 쳐다보게 만든다. bind 함수는 기본적으로 함수가 어디에서 언제 호출이되건 <code>this</code>값을 유지하게 해준다. <code>this</code>를 가져다가 event를 다룰 때 특별히 유용하다.</p>
<h2>Utilities</h2>
<p>그리고 쓰기에 더 괜찮은게, underscore는 utility 함수들을 대량으로 지원한다. 시간이 없으니 크고 아름다운 것 하나만 보자.</p>
<h3>Templating</h3>
<p>이미 template을 만드는 많은 solution들이 있지만 underscore는 강력하면서 구현이 적다는데 장점이 있다. 대충 예제를 하나 만들어보면</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> data =   &#123;site: <span class="string">'NetTuts'</span>&#125;, template =   <span class="string">'Welcome! You are at &lt;%= site %&gt;'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> parsedTemplate = _.template(template,  data );</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(parsedTemplate);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Welcome! You are at NetTuts</span></span><br></pre></td></tr></table></figure>
<p>우선, template를 통해 template으로 옮겨서 데이터를 만들 수 있다. 기본적으로, underscore는 모두 custom할 수 있는 ERB(embeded Ruby) 스타일 문자를 사용한다. 그 자리에, template과 data를 가지고 <code>template</code>을 간단하게 호출하면 된다. 필요하면 나중에 업데이트하기 위해 분리된 문자열에 결과를 저장한다.</p>
<p>이건 underscore의 template 중에서 극단적으로 간단한 예제라는걸 명심해라. <code>&lt;% %&gt;</code> 문자를 이용한 template 안쪽에서 어떤 JavaScript 코드를 사용할 수 있다. JSON같은 복잡한 객체를 훑을 필요가 있을 때에는 underscore의 우수한 collection 함수들과 함께 template을 빠르게 만들 수도 있다.</p>
<h2>여전히 왜 써야하는지 모르겠다면</h2>
<blockquote>
<p>jQuery와 underscore를 함께</p>
</blockquote>
<p>jQuery와 underscore는 상호보완적인 것이라 함께 쓰면 더 좋다. 자, jQuery는 아주 괜찮은 케이스들도 있다. DOM을 다룬다거나 애니메이션같은 것들이 말이다. 하지만 더 고수준이나 저수준을 다루지는 않는다. 고수준 이슈를 다루는 Backbone이나 Knockout같은 프레임웍이라면 필요한 부분에 전부 끼워넣을 수 있다.</p>
<p>좀 더 넓게 보자면, jQuery는 DOM을 다루는 기능 때문에 브라우저 밖에서는 거의 쓸 일이 없다. 다른 면으로 underscore는 브라우져에서도 사용할 수 있고 server단에서도 별 이슈없이 사용할 수 있다. 사실, underscore는 node module들이 제일 많이 의존하고 있다. 지금 말한건 그렇다. underscore의 활용에 대해서는 겉만 살짝 긁은 정도다.</p>
</div><footer class="post__foot u-cf"><ul class="post__tag u-fl"><li class="post__tag__item"><a href="/blog/tags/underscore/" class="post__tag__link">underscore</a></li></ul><a href="https://github.com/seoh/blog/tree/master/source/_posts/getting-cozy-with-underscore-js.md" class="post__foot-link u-fr">Pull Request</a><a href="https://github.com/seoh/blog/issues/new" class="post__foot-link u-fr">Tell me</a></footer></article><article class="post"><header class="post__head"><time datetime="2012-10-07T18:55:00.000Z" class="post__time">8th Oct, 2012</time><h1 class="post__title"><a href="/blog/2012/10/08/typescript-syntax-summary/">typescript syntax summary</a></h1></header><div class="post__main echo"><p>Microsoft가 며칠전 typescript를 발표했다. 아마 CoffeeScript처럼 ECMA Script 표준에 본격적으로 뛰어들기 위한 포석이 아닐까 싶은데, 어찌되었건 현재로는 무려 major IDE(라고는 하지만 Visual studio)에서도 강력하게 지원하고, 사람들이 많이 쓰는 <a href="http://blogs.msdn.com/b/interoperability/archive/2012/10/01/sublime-text-vi-emacs-typescript-enabled.aspx" target="_blank" rel="external">Sublime Text2, Emacs, Vim에서도 플러그인으로 지원</a>된다. 심지어 며칠전에 추가했던 SyntaxHighlighter의 <a href="http://ianobermiller.com/blog/2012/10/03/typescript-syntax-highlighting-for-wordpress/" target="_blank" rel="external">typescript 버전</a>도 벌써 올라왔다. 여하튼 좋은지 아닌지는 일단 적당히 써본 다음에 판단할 수 있으니 발이라도 살짝 담궈보기 위해서 Language Specification 문서를 받아봤으나 읽기엔 너무 길어서 dictation 연습이나 할까 하고 <a href="http://channel9.msdn.com/posts/Anders-Hejlsberg-Introducing-TypeScript" target="_blank" rel="external">소개 동영상</a>을 보려고 시도했다...고 하지만 1분만에 포기하고 그냥 언급된 소스만 보면서 메모해놓은 것들을 정리해봤다.</p>
<h3>typescript syntax summary</h3>
<p>variable type (declared like scala)
// number, string, bool</p>
<p>var name:type;
array expression.
x: string[]</p>
<p>: lambda expression.
() =&gt; retVal</p>
<p>: arg =&gt; retVal
(a: number, b: string) =&gt; a + b</p>
<p>interface declaration and usage</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="interface"><span class="keyword">interface</span> Thing </span>&#123;</span><br><span class="line">    a: <span class="built_in">number</span>;</span><br><span class="line">    b: <span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">process</span>(<span class="params">x: Thing</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x.a;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>object argument is expressed …</p>
<figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">process</span><span class="params">(x: &#123;a: number, b: string&#125;)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x.a;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>and also expressed</p>
<figure class="highlight inform7"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">function process(x: <span class="keyword">Thing</span>) &#123;</span><br><span class="line">    return x.a;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>optional property</p>
<figure class="highlight inform7"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">interface <span class="keyword">Thing</span> &#123;</span><br><span class="line">    a: number;</span><br><span class="line">    b?: string;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>method; function property</p>
<figure class="highlight inform7"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">interface <span class="keyword">Thing</span> &#123;</span><br><span class="line">    a: number;</span><br><span class="line">    foo(s: string, n?: number): string</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>method overload ...</p>
<figure class="highlight inform7"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">interface <span class="keyword">Thing</span> &#123;</span><br><span class="line">    a: number;</span><br><span class="line">    foo(s: string, n?: number): string;</span><br><span class="line">    foo(n: number): number;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">var process = function(x: <span class="keyword">Thing</span>) &#123;</span><br><span class="line">    x.foo(<span class="string">"abc"</span>,1)</span><br><span class="line">    x.foo(<span class="string">"abc"</span>)</span><br><span class="line">    x.foo(1)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>and also expressed</p>
<figure class="highlight inform7"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">interface <span class="keyword">Thing</span> &#123;</span><br><span class="line">    a: number;</span><br><span class="line">    foo: &#123;</span><br><span class="line">        (s: string, n?: number): string;</span><br><span class="line">        (n: number): number;</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>you cannot use that way</p>
<figure class="highlight inform7"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">interface <span class="keyword">Thing</span> &#123;</span><br><span class="line">    a: number;</span><br><span class="line">    foo: &#123;</span><br><span class="line">        (n?: number, s: string): string;</span><br><span class="line">        (n: number): number;</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>you may wanna use that, then compiler tells you
Optional parameters may only be followed by other optional parameters</p>
<figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123; (n?: <span class="type">number</span>,s: <span class="type">string</span>): <span class="type">string</span>; (n: <span class="type">number</span>): <span class="type">number</span>; &#125;</span><br></pre></td></tr></table></figure>
<p>method overload groupping</p>
<figure class="highlight inform7"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">interface <span class="keyword">Thing</span> &#123;</span><br><span class="line">    a: number;</span><br><span class="line">    foo: &#123;</span><br><span class="line">        (s: string): string;</span><br><span class="line">        (n: number): number;</span><br><span class="line">        data: any;</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">var process = function(x: <span class="keyword">Thing</span>) &#123;</span><br><span class="line">    x.foo(1)</span><br><span class="line">    x.foo(<span class="string">"abc"</span>)</span><br><span class="line">    x.foo.data = 1</span><br><span class="line">    x.foo.data = <span class="string">"abc"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>pre-declared method overload: index method like array, constructor method</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="interface"><span class="keyword">interface</span> Thing </span>&#123;</span><br><span class="line">    a: <span class="built_in">number</span>;</span><br><span class="line">    b: <span class="built_in">string</span>;</span><br><span class="line">    foo: &#123;</span><br><span class="line">        (s: <span class="built_in">string</span>): <span class="built_in">string</span>;</span><br><span class="line">        (n: <span class="built_in">number</span>): <span class="built_in">number</span>;</span><br><span class="line">        data: <span class="built_in">any</span>;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">new</span> (s: <span class="built_in">string</span>): Element;</span><br><span class="line">    [index: <span class="built_in">number</span>]: <span class="built_in">Date</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>class definition</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> Point &#123;</span><br><span class="line">    <span class="comment">// property</span></span><br><span class="line">    x: <span class="built_in">number</span>;</span><br><span class="line">    y: <span class="built_in">number</span>;</span><br><span class="line">    <span class="constructor"><span class="keyword">constructor</span>(x: <span class="built_in">number</span>, y: <span class="built_in">number</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.x = x;</span><br><span class="line">        <span class="keyword">this</span>.y = y;</span><br><span class="line">    &#125;</span><br><span class="line">    dist() &#123; </span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">Math</span>.sqrt(<span class="keyword">this</span>.x*<span class="keyword">this</span>.x + <span class="keyword">this</span>.y*<span class="keyword">this</span>.y);</span><br><span class="line">    &#125;</span><br><span class="line">    static origin = <span class="keyword">new</span> Point(<span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> p = <span class="keyword">new</span> Point(<span class="number">10</span>, <span class="number">10</span>);</span><br><span class="line">p.x = <span class="number">10</span>;</span><br><span class="line">Point.origin.x;</span><br></pre></td></tr></table></figure>
<p>private member: but not in real, just compiler tells &quot;it can`t&quot;</p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">Point</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> color: <span class="keyword">string</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>-&gt;</p>
<figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> Point = (<span class="function"><span class="keyword">function</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">Point</span><span class="params">(x, y)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.color = <span class="string">'red'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure>
<p>constructor with declaration</p>
<figure class="highlight delphi"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">constructor</span><span class="params">( <span class="keyword">public</span> x: number, <span class="keyword">public</span> y: number)</span></span></span><br></pre></td></tr></table></figure>
<p>constructor with default value</p>
<figure class="highlight delphi"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">constructor</span><span class="params">( <span class="keyword">public</span> x: number = 0, <span class="keyword">public</span> y: number = 0)</span></span></span><br></pre></td></tr></table></figure>
<p>inheritance // can be use an acceessor (can be duplicated declaration in scope)</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> Point &#123;</span><br><span class="line">    <span class="constructor"><span class="keyword">constructor</span>(<span class="keyword">public</span> x: <span class="built_in">number</span>, <span class="keyword">public</span> y: <span class="built_in">number</span>) </span>&#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> Point3D extends Point &#123;</span><br><span class="line">    <span class="constructor"><span class="keyword">constructor</span>(x: <span class="built_in">number</span>, y: <span class="built_in">number</span>, <span class="keyword">public</span> z: <span class="built_in">number</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(x, y);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>auto-generated closure // compare next sources</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Tracker</span> </span>&#123;</span><br><span class="line">    count = <span class="number">0</span>;</span><br><span class="line">    start() &#123;</span><br><span class="line">        <span class="comment">// legacy expression</span></span><br><span class="line">        <span class="keyword">var</span> that = <span class="keyword">this</span></span><br><span class="line">        <span class="built_in">window</span>.onmousemove = <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">            that.count++;</span><br><span class="line">            <span class="built_in">console</span>.log(that.count);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">(<span class="keyword">new</span> Tracker()).start();</span><br></pre></td></tr></table></figure>
<p>and</p>
<figure class="highlight axapta"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Tracker</span> </span>&#123;</span><br><span class="line">    <span class="keyword">count</span> = <span class="number">0</span>;</span><br><span class="line">    start() &#123;</span><br><span class="line">        <span class="comment">// lambda expression</span></span><br><span class="line">        window.onmousemove = e =&gt; &#123;</span><br><span class="line">            <span class="keyword">this</span>.<span class="keyword">count</span>++;</span><br><span class="line">            console.log(<span class="keyword">this</span>.<span class="keyword">count</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">(<span class="keyword">new</span> Tracker()).start();</span><br></pre></td></tr></table></figure>
<p>module declaration</p>
<figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span> Hierarchical.Module.Name.Is.Available &#123;</span><br><span class="line">    <span class="reserved">export</span> <span class="class"><span class="keyword">class</span> <span class="title">Point</span> &#123;&#125;</span></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">PrivateClass</span> &#123;&#125;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span> Hierarchical.Module.Name.Is.Available &#123;</span><br><span class="line">    <span class="reserved">export</span> <span class="reserved">var</span> partialDeclare</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="reserved">var</span> shortedPath = Hierarchical.Module.Name.Is.Available</span><br><span class="line"><span class="reserved">var</span> p = <span class="keyword">new</span> shortedPath.Point</span><br></pre></td></tr></table></figure>
<p>external module and function</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// target.ts</span></span><br><span class="line"><span class="keyword">export</span> <span class="built_in">module</span> target &#123;</span><br><span class="line">    <span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">Dog</span> </span>&#123;</span><br><span class="line">        bark = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">"bow wow"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">version</span>(<span class="params"></span>)  </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"v0.0.1"</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// main.ts</span></span><br><span class="line">import t = <span class="function"><span class="title">module</span><span class="params">(<span class="string">"target"</span>)</span></span></span><br><span class="line">console.<span class="function"><span class="title">log</span><span class="params">( (new t.target.Dog)</span></span>.<span class="function"><span class="title">bark</span><span class="params">()</span></span> )</span><br><span class="line">console.<span class="function"><span class="title">log</span><span class="params">( t.version()</span></span> )</span><br></pre></td></tr></table></figure>
<p>=&gt;</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">(<span class="number">03</span>:<span class="number">13</span>:<span class="number">55</span>) <span class="built_in">test</span> seoh$ tsc main.ts <span class="operator">-e</span></span><br><span class="line">bow wow</span><br><span class="line">v0.<span class="number">0.1</span></span><br></pre></td></tr></table></figure>
<p>다른 소스를 보다보면 node.d.ts, jquery.d.ts같은 파일들이 있는데, declarations 옵션으로 컴파일을 하면 c/c++의 header와 같은 개념으로 decoration typescript(d.ts) 파일이 생성된다. 예를들어 위에 있는 target.ts를 컴파일하면</p>
<figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">(<span class="number">03</span>:<span class="number">50</span>:<span class="number">16</span>) test seoh$ tsc --declarations target.ts</span><br><span class="line">(<span class="number">03</span>:<span class="number">50</span>:<span class="number">23</span>) test seoh$ cat target.d.ts </span><br><span class="line">export module target &#123;</span><br><span class="line">    export <span class="class"><span class="keyword">class</span> <span class="title">Dog</span> </span>&#123;</span><br><span class="line">        <span class="keyword">public</span> bark: () =&gt; string;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">export <span class="function"><span class="keyword">function</span> <span class="title">version</span><span class="params">()</span><span class="type">: string</span></span>;</span><br></pre></td></tr></table></figure>
<p>처럼 선언만 남게 된다.</p>
<p>요즘 만지작거리고 있는 스칼라와 문법이 흡사해서 재미있기도 하고, module, class 개념으로 큰 프로젝트에서 분업할 때 편하긴 할 것 같은데... 아직 어디에 써야할지는 감이 안온다. 다른거 만지다보면 누군가 이런저런 토픽을 던저줄테니 일단 받아먹을 준비 중.</p>
<p>* 위에서 언급된 소스들은 module 부분을 제외하고 Microsoft의 동영상 소개에서 가져온 내용이니 해당 소스들에 대한 권리는 MS에게 있습니다.</p>
</div><footer class="post__foot u-cf"><ul class="post__tag u-fl"><li class="post__tag__item"><a href="/blog/tags/typescript/" class="post__tag__link">typescript</a></li></ul><a href="https://github.com/seoh/blog/tree/master/source/_posts/typescript-syntax-summary.md" class="post__foot-link u-fr">Pull Request</a><a href="https://github.com/seoh/blog/issues/new" class="post__foot-link u-fr">Tell me</a></footer></article><article class="post"><header class="post__head"><time datetime="2012-09-25T15:28:00.000Z" class="post__time">26th Sep, 2012</time><h1 class="post__title"><a href="/blog/2012/09/26/comparison-with-drm-free-ebook-publishers/">DRM-free eBook 출판사 비교</a></h1></header><div class="post__main echo"><p>&quot;<a href="http://www.insightbook.co.kr/post/2361" target="_blank" rel="external">인사이트가 PDF 서비스를 시작합니다.</a>&quot; 한국에서 최초로 DRM-free의 eBook을 출간한 회사가 '인사이트'가 아닐까.  4월 18일 저 글이 올라온 이후로 현재까지 인사이트에서는 <a href="http://ebook.insightbook.co.kr/" target="_blank" rel="external">인사이트 eBook</a>에서 11권의 책을 9800원(뽀모도로 테크닉)~27000원(파이썬 완벽 가이트)를 PDF로 판매하고 있다. 어디 한 플랫폼에 종속되는 것을 싫어해서 그때까지 eBook을 구매한 적이 없었는데 인사이트의 이 판매를 보고 반가워서 응원도 할 겸 이벤트(종이책을 구매하는 사람에게 일정기간동안 파이썬 완벽가이드를 27000-&gt;14000으로 할인)도 하는 겸 구매했던 것과 리팩터링 워크북을 포함해 2권을 구매했고 Closure나 Ruby 책도 고민 중에 있다. 그러던 차에 오늘 검색 중 반가운 소식을 들었다. IT서적 전문의 다른 출판사인 한빛미디어에서도 DRM-free eBook을 판매하기 시작했다는 <a href="http://www.hanb.co.kr/ebook/about_ebook.html" target="_blank" rel="external">소개페이지</a>를 발견했다.</p>
<p>IT말고 다른 분야에서도 DRM-free가 나왔으면 좋겠다는 생각도 들었지만 어쨌거나 보는 책의 반 이상, 아니 대다수가 IT관련 책이니 나에게는 좋은 일. &quot;유지보수하기 어렵게 코딩하는 방법: 평생 개발자로 먹고 살 수 있다&quot;라는 무료책을 비롯하여 현재 5권을 판매중이며 가격은 9900원(무료와 자바...를 제외한 나머지 세 책들)~11000원(자바 개발자를 위한 함수형 프로그래밍)로 인사이트에 비해 비교적 저렴한 편이나 대체로 얇은 책들 위주. 여하튼 굉장히 주관적이고 비논리적인 시각으로 특징을 비교해보자면</p>
<p><img src="/blog/images/comparison-with-drm-free-ebook-publishers/1.png" alt="" title="파이썬 완벽 가이드(인사이트) vs 함수형 프로그래밍(한빛미디어)">
<img src="/blog/images/comparison-with-drm-free-ebook-publishers/2.png" alt="" title="파이썬 완벽 가이드(인사이트) vs 함수형 프로그래밍(한빛미디어)"></p>
<ul>
<li>
<p>인사이트</p>
<ul>
<li>주로 기초 서적</li>
<li>(페이지 대비) 저렴한 가격
<ul>
<li>레퍼런스 북 위주라 두꺼운 책들</li>
</ul>
</li>
<li>출간본 그대로의 모습
<ul>
<li>작은 폰트</li>
<li>좌/우 페이지의 좌/우 여백이 다름</li>
</ul>
</li>
<li>구매시 불편함
<ul>
<li>하루 2번 배송</li>
<li>only 무통장입금</li>
</ul>
</li>
</ul>
</li>
<li>
<p>한빛미디어</p>
<ul>
<li>time to market 같은 책들
<ul>
<li>&quot;핵심적인 내용을 빠르게 전달하기 위해 조금 거칠지만 100page 내외의 전자책 전용&quot; - 소개 페이지 中</li>
</ul>
</li>
<li>eBook에 맞춘 편집
<ul>
<li>큰 폰트</li>
<li>(비교적) 적은 여백, 넓은 행간</li>
</ul>
</li>
<li>책보다는 포스팅이나 매거진 느낌
<ul>
<li>&quot;보완되고 발전된 노하우가 정리되면 구매하신 분께 무료로 업데이트&quot; - 소개 페이지 中</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>써놓고 나니 책 가격을 페이지에 비례해서 책정한다는건 무척 어리석은 일이지만 모든 책을 읽어볼 수 없으니 그냥 공개된 정보만 훑어보다가 들었던 생각이다. 어느 쪽이 더 좋은가? 어디가 더 많이 팔릴까? 라고 잠깐 생각을 해봤는데 둘 다 썩 좋은 질문은 아닌거 같다. 단순히 '편집'만 가지고 이야기를 하자면, 여백이나 행간은 한빛쪽이 확실히 읽기 좋고 폰트 자체는 인사이트쪽이 읽기 좋고, 작은 폰트는 아이패드류나 데스크탑에서 읽기 편하고 큰 폰트는 5&quot;~7&quot; 정도에서 읽기 편하다. (그 이하의 화면 크기는 PDF 자체가 읽기 불편하다.) 책 종류 자체도 인사이트는 기본서(혹은 레퍼런스)같은 느낌이고 한빛은  실용서(혹은 노하우)같은 느낌이다. 둘 다 필요한 종류의 책들.</p>
<p>비교 이외의 한가지 토픽을 더 던지자면, DRM-free에 대한 정보가 더 없나 검색하다가 &quot;<a href="http://www.hanb.co.kr/network/view.html?bi_id=1821" target="_blank" rel="external">DRM으로부터의 해방, 영원히</a>&quot;라는 글을 읽었다. 사실 eBook이 유행하기 전에도 어둠의 경로로는 만화/소설/잡지 등의 스캔이 떠돌고 있었고 여전히 그렇다. 이런 상황에서 DRM이 없어지면 '무단 복제'가 더 빈번해질까? 판매량이 더 감소할까? 저 링크 속의 글에 있는 &quot;이해할 수 없는 것은, 책 판매량은 줄지 않았다는 것이다. 사실, 판매량은 그 해에 살짝 올라갔다.&quot;라는 말이 한국의 실정에도 적용될 수는 없더라도 그 의미를 같이 하지 않을까. 그렇기에 인사이트나 한빛미디어에서도 이런 도전을 하고 있는 것이겠고, 그것을 응원한다 :)</p>
</div><footer class="post__foot u-cf"><ul class="post__tag u-fl"><li class="post__tag__item"><a href="/blog/tags/drm-free/" class="post__tag__link">drm-free</a></li><li class="post__tag__item"><a href="/blog/tags/eBook/" class="post__tag__link">eBook</a></li><li class="post__tag__item"><a href="/blog/tags/인사이트/" class="post__tag__link">인사이트</a></li><li class="post__tag__item"><a href="/blog/tags/한빛미디어/" class="post__tag__link">한빛미디어</a></li></ul><a href="https://github.com/seoh/blog/tree/master/source/_posts/comparison-with-drm-free-ebook-publishers.md" class="post__foot-link u-fr">Pull Request</a><a href="https://github.com/seoh/blog/issues/new" class="post__foot-link u-fr">Tell me</a></footer></article></main><footer class="foot"><div class="foot-copy u-fl">&copy; 2015 Seoh Char</div><menu class="page-menu u-fr"><li class="page-menu__item"><a title="Previous" href="/blog/" class="page-menu__link icon-arrow-left"></a></li><li class="page-menu__item"><a title="Next" href="/blog/page/3/" class="page-menu__link icon-arrow-right"></a></li></menu></footer><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=
function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;
e=o.createElement(i);r=o.getElementsByTagName(i)[0];
e.src='//www.google-analytics.com/analytics.js';
r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));
ga('create','UA-52090105-1');ga('send','pageview');
</script></body></html>